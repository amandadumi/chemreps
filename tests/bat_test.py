from chemreps.bagger import BagMaker
from chemreps.bat import bat
import numpy as np
import pytest as pt
from collections import OrderedDict


def test_bat():
    bags_true = OrderedDict(
        [("C", 16), ("CC", 120), ("CCC", 11), ("CCCC", 8), ("CCCH", 25), ("CCCN", 4), ("CCCO", 5), ("CCCS", 2),
         ("CCH", 23), ("CCN", 7), ("CCNH", 3), ("CCO", 7), ("CCOH", 1), ("CCS", 4), ("CH", 288), ("CNC", 4),
         ("CNCC", 11), ("CNCH", 5), ("CNCO", 3), ("CNCS", 2), ("CNH", 2), ("COC", 1), ("COCC", 3), ("COCH", 2),
         ("COH", 1), ("CSC", 1), ("CSCC", 4), ("CSCH", 1), ("CSCN", 1), ("H", 18), ("HCCH", 16), ("HCCN", 5), ("HCCO", 7),
         ("HCCS", 8), ("HCH", 8), ("HCN", 3), ("HCO", 2), ("HCS", 1), ("HH", 153), ("HNCH", 1), ("HNCO", 1),
         ("HOCO", 1), ("HOH", 1), ("N", 2), ("NC", 32), ("NCCN", 2), ("NCCO", 4), ("NCCS", 2), ("NCO", 2),
         ("NCS", 1), ("NH", 36), ("NN", 1), ("O", 5), ("OC", 80), ("OCCO", 1), ("OCO", 1), ("OH", 90),
         ("ON", 10), ("OO", 10), ("S", 1), ("SC", 16), ("SH", 18), ("SN", 2), ("SO", 5), ])

    bat_true = np.array([
        36.8438, 36.8438, 36.8438, 36.8438, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 23.3750, 23.3750, 23.3281, 14.1484, 14.1484, 9.1953, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 1.9434, 1.9434, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        3.1406, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 3.1406, 3.1406, 1.0508, 1.0508, 1.0508, 1.0508, 1.0293, 1.0293, 1.0293, 1.0293, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 1.9316,
        1.9316, 1.9316, 1.9316, 1.9238, 1.9238, 1.9150, 1.9150, 1.9150, 1.9150, 1.9062, 1.9062, 1.9062, 1.9062, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        5.4922, 5.4922, 5.4922, 5.4922, 5.4922, 5.4922, 5.4922, 5.4922, 5.4922, 5.4922, 2.7754, 2.7754, 2.7754, 2.7754, 2.7617, 2.7617, 2.7617, 2.7617, 2.7598, 2.7598, 2.7520, 2.7520, 2.7520, 2.7520, 2.1621,
        2.1621, 2.1621, 2.1621, 2.1445, 2.1445, 2.1445, 2.1445, 1.7168, 1.7168, 1.4199, 1.4199, 1.4199, 1.4199, 1.2725, 1.2725, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000,
        0.5000, 0.5000, 0.5000, 0.5000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 3.1406, 3.1406, 3.1152, 3.1152, 3.1152, 3.1152, 1.0830, 1.0830, 1.0664, 1.0664, 1.0664, 1.0664,
        1.0244, 1.0244, 1.0244, 1.0244, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 1.8955, 1.8955, 1.8906, 1.8906, 1.8906, 1.8896, 1.8770, 1.8770, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5669, 0.5669, 0.5649, 0.5649,
        0.5649, 0.5649, 0.5635, 0.5635, 0.4016, 0.4016, 0.4016, 0.4016, 0.3982, 0.3982, 0.3982, 0.3982, 0.3975, 0.3975, 0.3870, 0.3870, 0.3870, 0.3870, 0.3254, 0.3254, 0.3254, 0.3254, 0.3254, 0.3254, 0.3193,
        0.3193, 0.3193, 0.3193, 0.2649, 0.2649, 0.2649, 0.2646, 0.2256, 0.2256, 0.2095, 0.2095, 0.2041, 0.2041, 0.2041, 0.2041, 0.1781, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000], dtype=np.float16)

    bagger = BagMaker("BAT", "data/sdf/")
    assert bagger.bag_sizes == bags_true

    rep = bat("data/sdf/butane.sdf", bagger.bags, bagger.bag_sizes)
    assert np.all(np.abs(bat_true - rep) <= 1e-4) == True

    rep = bat("data/cml/butane.cml", bagger.bags, bagger.bag_sizes)
    assert np.all(np.abs(bat_true - rep) <= 1e-4) == True

    with pt.raises(NotImplementedError):
        rep = bat("data/xyz/butane.xyz", bagger.bags, bagger.bag_sizes)

    with pt.raises(NotImplementedError):
        bagger = BagMaker("BAT", "data/xyz/")

    pen_bat_true = np.array([
        36.8438, 36.8438, 36.8438, 36.8438, 36.8438, 36.8438, 36.8438, 36.8438, 36.8438, 36.8438, 36.8438, 36.8438, 36.8438, 36.8438, 36.8438, 36.8438, 0.0000, 25.9375, 25.9375, 25.8125, 25.8125, 25.8125, 25.8125, 24.0781, 23.7812,
        23.5469, 23.4531, 23.4531, 23.3438, 23.3125, 17.1719, 15.1328, 14.9766, 14.9766, 14.8984, 14.8984, 14.8984, 14.8984, 14.4141, 14.3359, 14.3359, 14.2969, 14.1797, 14.0156, 13.8984, 13.6406, 12.9688, 12.9609, 12.9062, 12.9062,
        12.3125, 11.0156, 10.7656, 10.7031, 10.5781, 10.1406, 10.0625, 10.0156, 9.9922, 9.9453, 9.4297, 9.4219, 9.3438, 9.0078, 8.6797, 8.4766, 8.1094, 7.8711, 7.8164, 7.7305, 7.5977, 7.5977, 7.5352, 7.3555, 7.2617,
        7.1836, 6.6367, 6.5234, 6.4414, 6.1367, 5.9219, 5.7344, 5.7148, 5.7109, 5.7031, 5.5391, 5.5234, 5.3398, 5.3047, 5.0938, 5.0703, 5.0312, 4.8750, 4.8477, 4.8008, 4.6680, 4.6016, 4.4219, 4.3945, 4.3477,
        4.1797, 4.1758, 4.1719, 4.1523, 4.1445, 4.1289, 4.0664, 4.0664, 3.9922, 3.8652, 3.8281, 3.7891, 3.7051, 3.6973, 3.6484, 3.6465, 3.6289, 3.6113, 3.6055, 3.5781, 3.5723, 3.5508, 3.4863, 3.3008, 3.2754,
        3.2656, 3.2617, 3.2500, 3.2031, 3.1992, 3.1953, 3.1641, 3.1621, 2.9668, 2.9297, 2.9102, 2.8965, 0.0000, 2.1113, 2.0938, 2.0938, 2.0938, 2.0859, 2.0859, 2.0117, 1.9990, 1.9443, 1.9209, 1.4990, 0.0000,
        1.6230, 0.5703, 0.0003, 0.0002, 0.0002, 0.0001, 0.0001, 0.0001, 0.0000, 3.1406, 3.1406, 3.1406, 3.1406, 3.1406, 3.1406, 3.1348, 3.1348, 3.1113, 3.1113, 3.1055, 3.1035, 3.0488, 3.0098, 2.7246, 1.9990,
        1.2002, 1.1514, 1.0850, 1.0674, 1.0059, 0.9990, 0.9419, 0.8984, 0.5303, 0.0000, 2.5762, 1.5146, 0.0038, 0.0036, 0.0000, 3.1406, 3.1406, 3.0156, 2.0176, 1.1250, 0.0000, 2.6172, 1.8057, 0.0000, 2.1406,
        2.1055, 2.0957, 2.0938, 2.0938, 2.0938, 2.0938, 2.0938, 2.0918, 2.0566, 2.0254, 1.9834, 1.9590, 1.9521, 1.9482, 1.9463, 1.9443, 1.9434, 1.9414, 1.9404, 1.8926, 1.8809, 1.8506, 0.0000, 2.0508, 1.9893,
        1.9609, 1.8760, 1.8701, 1.5889, 1.5283, 0.0000, 1.3262, 0.3887, 0.0097, 0.0000, 2.3711, 2.1816, 2.1465, 2.0859, 2.0859, 1.9316, 1.9307, 0.0000, 3.1406, 0.0000, 2.0371, 1.9023, 1.8838, 1.8096, 0.0000,
        5.5234, 5.5234, 5.5234, 5.5234, 5.5234, 5.4844, 5.4766, 5.4766, 5.4766, 5.4766, 5.4727, 5.4727, 5.4727, 5.4648, 5.4609, 5.4609, 3.0820, 2.8945, 2.8555, 2.8477, 2.8184, 2.8164, 2.7871, 2.7852, 2.7852,
        2.7852, 2.7852, 2.7852, 2.7852, 2.7852, 2.7773, 2.7578, 2.7520, 2.7480, 2.7461, 2.7422, 2.7422, 2.7363, 2.7305, 2.7285, 2.7090, 2.6758, 2.4082, 2.3672, 2.3672, 2.3379, 2.3105, 2.2930, 2.2383, 2.2168,
        2.1816, 2.1816, 2.1719, 2.1680, 2.1582, 2.1543, 2.1309, 2.1074, 2.0938, 2.0723, 2.0527, 2.0469, 2.0273, 2.0020, 1.9756, 1.9043, 1.8896, 1.8877, 1.8604, 1.8535, 1.8174, 1.7725, 1.7705, 1.7695, 1.7656,
        1.7646, 1.7646, 1.7646, 1.7646, 1.7637, 1.7578, 1.7236, 1.7227, 1.7139, 1.7119, 1.6973, 1.6738, 1.6094, 1.5742, 1.5703, 1.5693, 1.5537, 1.5488, 1.5488, 1.5488, 1.5479, 1.5430, 1.5322, 1.5225, 1.5215,
        1.5166, 1.4971, 1.4932, 1.4883, 1.4717, 1.4492, 1.4492, 1.4424, 1.4355, 1.4316, 1.4258, 1.4199, 1.4062, 1.3848, 1.3799, 1.3750, 1.3564, 1.3330, 1.3311, 1.2920, 1.2910, 1.2861, 1.2754, 1.2676, 1.2588,
        1.2588, 1.2520, 1.2490, 1.2451, 1.2451, 1.2393, 1.2246, 1.1826, 1.1748, 1.1631, 1.1572, 1.1514, 1.1484, 1.1367, 1.1299, 1.1279, 1.1250, 1.1133, 1.1064, 1.1025, 1.0938, 1.0928, 1.0918, 1.0771, 1.0742,
        1.0723, 1.0547, 1.0361, 1.0273, 1.0059, 0.9995, 0.9976, 0.9966, 0.9912, 0.9858, 0.9839, 0.9834, 0.9775, 0.9668, 0.9600, 0.9565, 0.9453, 0.9414, 0.9385, 0.9082, 0.9072, 0.8945, 0.8887, 0.8784, 0.8770,
        0.8623, 0.8579, 0.8574, 0.8555, 0.8540, 0.8506, 0.8496, 0.8447, 0.8232, 0.8169, 0.8057, 0.8022, 0.7979, 0.7910, 0.7783, 0.7739, 0.7700, 0.7637, 0.7603, 0.7559, 0.7539, 0.7397, 0.7393, 0.7383, 0.7271,
        0.7261, 0.7236, 0.7227, 0.7183, 0.7148, 0.7129, 0.7129, 0.6963, 0.6934, 0.6855, 0.6689, 0.6660, 0.6587, 0.6577, 0.6538, 0.6470, 0.6426, 0.6382, 0.6333, 0.6323, 0.6235, 0.6221, 0.6216, 0.6152, 0.6143,
        0.6118, 0.6104, 0.6021, 0.6001, 0.5981, 0.5977, 0.5972, 0.5952, 0.5903, 0.5898, 0.5894, 0.5869, 0.5864, 0.5850, 0.5767, 0.5747, 0.5728, 0.5708, 0.5659, 0.5640, 0.5620, 0.5596, 0.5586, 0.5571, 0.5537,
        0.5532, 0.5469, 0.5469, 0.5449, 0.5293, 0.5283, 0.5273, 0.5273, 0.5244, 0.5220, 0.5186, 0.5166, 0.5088, 0.5068, 0.5039, 0.5024, 0.5005, 0.4998, 0.4971, 0.4951, 0.4939, 0.4917, 0.4917, 0.4905, 0.4851,
        0.4846, 0.4841, 0.4839, 0.4622, 0.4597, 0.4597, 0.4578, 0.4539, 0.4514, 0.4507, 0.4480, 0.4255, 0.4246, 0.0000, 2.1855, 2.1465, 2.0781, 1.6670, 0.0000, 3.1406, 2.7617, 2.3730, 2.3145, 2.3008, 2.2656,
        1.8447, 1.8066, 0.1411, 0.0040, 0.0040, 0.0000, 2.0508, 1.9551, 1.8643, 0.5361, 0.1688, 0.0000, 3.0215, 0.7246, 0.0001, 0.0000, 2.0371, 0.3311, 0.0000, 2.0840, 2.0527, 0.0000, 2.0449, 0.0000, 2.6172,
        2.6152, 0.5234, 0.0000, 1.5820, 0.5537, 0.0000, 1.9541, 0.0000, 1.5918, 0.0000, 2.7070, 2.1895, 1.4912, 0.6353, 0.0000, 1.6143, 0.0000, 0.5474, 0.0000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000,
        0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.0000, 0.0519, 0.0224, 0.0053, 0.0012, 0.0007, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 2.2773, 1.9824, 1.9434, 1.0547, 1.0059, 0.0000, 2.1348, 2.0879, 2.0762, 1.2812, 1.0635, 0.0314, 0.0001, 0.0000, 3.1367, 3.0781, 2.5312, 1.5117, 1.1064, 1.0625,
        1.0430, 1.0059, 0.0000, 1.9199, 1.8809, 1.8799, 1.8730, 1.8721, 1.8682, 1.8604, 0.0000, 0.0000, 1.9697, 1.9541, 1.8691, 0.0000, 1.9561, 1.9121, 0.0000, 2.0215, 0.0000, 0.5688, 0.5674, 0.5669, 0.5664,
        0.5649, 0.5645, 0.5566, 0.4329, 0.4177, 0.4153, 0.4102, 0.4089, 0.4072, 0.4036, 0.4031, 0.4031, 0.4004, 0.3892, 0.3884, 0.3806, 0.3459, 0.3325, 0.3264, 0.3157, 0.3125, 0.2903, 0.2856, 0.2739, 0.2729,
        0.2654, 0.2646, 0.2646, 0.2644, 0.2642, 0.2642, 0.2578, 0.2495, 0.2483, 0.2379, 0.2377, 0.2374, 0.2366, 0.2340, 0.2338, 0.2328, 0.2328, 0.2314, 0.2300, 0.2296, 0.2288, 0.2284, 0.2203, 0.2162, 0.2158,
        0.2144, 0.2072, 0.2056, 0.2025, 0.2015, 0.2015, 0.1992, 0.1987, 0.1976, 0.1875, 0.1873, 0.1815, 0.1794, 0.1772, 0.1768, 0.1755, 0.1752, 0.1732, 0.1718, 0.1676, 0.1675, 0.1669, 0.1665, 0.1658, 0.1604,
        0.1591, 0.1591, 0.1584, 0.1576, 0.1569, 0.1565, 0.1545, 0.1523, 0.1519, 0.1476, 0.1458, 0.1420, 0.1418, 0.1414, 0.1398, 0.1396, 0.1394, 0.1359, 0.1337, 0.1283, 0.1266, 0.1260, 0.1256, 0.1246, 0.1241,
        0.1237, 0.1230, 0.1176, 0.1144, 0.1144, 0.1125, 0.1111, 0.1086, 0.1079, 0.1075, 0.1061, 0.1054, 0.1038, 0.1022, 0.1006, 0.0994, 0.0984, 0.0982, 0.0972, 0.0931, 0.0929, 0.0926, 0.0911, 0.0908, 0.0904,
        0.0876, 0.0872, 0.0867, 0.0858, 0.0858, 0.0857, 0.0849, 0.0845, 0.0833, 0.0812, 0.0806, 0.0800, 0.0770, 0.0762, 0.0762, 0.0760, 0.0755, 0.0747, 0.0745, 0.0745, 0.0712, 0.0703, 0.0665, 0.0663, 0.0000,
        2.6152, 0.0000, 3.1328, 0.0000, 0.0031, 0.0000, 0.0000, 0.0000, 53.3438, 53.3438, 0.0000, 30.7656, 30.0938, 28.9844, 28.6562, 28.5781, 20.2031, 17.7344, 17.3906, 17.3750, 16.6250, 16.3594, 12.9688, 11.3516, 10.2188,
        9.5547, 9.4531, 8.8750, 8.2812, 8.0469, 7.7422, 7.6328, 7.5664, 7.2070, 6.5742, 6.0000, 5.8008, 5.3125, 5.1602, 4.6680, 4.4570, 4.1250, 4.0508, 0.0000, 2.0703, 2.0098, 0.0000, 3.1309, 3.0703, 0.9497,
        0.0690, 0.0000, 0.5332, 0.2012, 0.0000, 2.3164, 2.1758, 0.0000, 1.8027, 0.0000, 6.8789, 3.3965, 3.2734, 3.2676, 2.6777, 2.6191, 2.4922, 2.3242, 2.0996, 2.0566, 1.8262, 1.8213, 1.7266, 1.7051, 1.6621,
        1.6230, 1.5527, 1.5156, 1.4404, 1.2949, 1.2686, 1.2334, 1.2314, 1.1846, 1.1738, 1.1426, 1.0938, 1.0137, 0.9614, 0.9312, 0.8872, 0.8467, 0.7725, 0.7139, 0.6333, 0.6157, 0.0000, 15.4219, 0.0000, 73.5000,
        73.5000, 73.5000, 73.5000, 73.5000, 0.0000, 39.6562, 39.2812, 39.0625, 35.4062, 34.9062, 34.0000, 20.4688, 20.1094, 20.1094, 19.9531, 19.9062, 19.8906, 18.7969, 16.5312, 16.0312, 15.3828, 14.8438, 14.6641, 14.5312, 13.6875,
        13.6797, 13.4453, 13.1250, 13.1250, 12.8438, 12.5000, 12.4531, 12.0859, 11.5625, 11.0000, 10.8516, 10.7656, 10.6016, 10.5469, 10.4375, 10.2969, 10.1562, 9.7812, 9.7578, 9.0781, 8.9766, 8.7188, 8.5547, 8.2031, 7.9844,
        7.9297, 7.8516, 7.8281, 7.7383, 7.1953, 6.9844, 6.7930, 6.7812, 6.6016, 6.4258, 6.3906, 6.3359, 6.3125, 6.1836, 5.9844, 5.8633, 5.6562, 5.6328, 5.5898, 5.5234, 5.3320, 5.0625, 5.0117, 4.5586, 4.4766,
        4.4180, 4.3906, 4.1328, 4.0117, 3.9824, 3.9492, 3.7598, 3.7129, 3.6406, 3.6270, 0.0000, 0.0097, 0.0000, 2.1680, 0.0000, 8.1562, 3.8906, 3.8281, 3.3164, 3.0801, 3.0391, 3.0234, 3.0156, 3.0000, 2.9277,
        2.8164, 2.6445, 2.5938, 2.5918, 2.5820, 2.5566, 2.5000, 2.4492, 2.3379, 2.1738, 2.1738, 2.0605, 2.0273, 1.9746, 1.9414, 1.9160, 1.8896, 1.8154, 1.8125, 1.7627, 1.7627, 1.7168, 1.6318, 1.6074, 1.6035,
        1.5938, 1.5928, 1.5879, 1.5605, 1.5273, 1.4951, 1.4873, 1.4668, 1.4277, 1.4004, 1.3613, 1.3398, 1.2949, 1.2861, 1.2842, 1.2559, 1.2529, 1.2500, 1.2217, 1.1924, 1.1641, 1.1406, 1.1367, 1.1299, 1.0908,
        1.0713, 1.0615, 1.0332, 1.0137, 0.9932, 0.9839, 0.9829, 0.9727, 0.9678, 0.9429, 0.9316, 0.9312, 0.9243, 0.8887, 0.8828, 0.8701, 0.8394, 0.7974, 0.7954, 0.7734, 0.7627, 0.7393, 0.6870, 0.6558, 0.6519,
        0.6465, 0.5869, 0.5752, 0.5664, 0.5635, 0.0000, 24.0938, 23.7344, 21.0938, 17.5000, 15.6484, 15.3672, 11.4062, 9.6562, 8.7188, 8.2656, 0.0000, 28.0781, 23.7500, 16.7031, 13.4375, 12.5703, 9.6797, 8.6094, 7.6289,
        6.7930, 6.4570, 0.0000, 388.0000, 0.0000, 52.4688, 51.5625, 35.7500, 34.8750, 34.6875, 33.4688, 28.6094, 24.4688, 23.8438, 20.3906, 13.7266, 13.3594, 11.7266, 11.2422, 10.2266, 10.0547, 0.0000, 6.3789, 5.4766, 5.3945,
        5.3828, 5.3594, 5.1094, 5.1055, 4.2656, 4.2539, 4.2461, 3.7676, 3.0703, 2.8340, 2.4668, 1.9268, 1.7969, 1.5488, 1.5127, 0.0000, 43.1875, 36.4688, 0.0000, 29.0469, 28.6250, 27.0781, 26.9844, 22.0469, 0.0000], dtype=np.float16)

    # maybe testing torsions?
    rep = bat("data/sdf/penicillin.sdf", bagger.bags, bagger.bag_sizes)
    assert np.all(np.abs(pen_bat_true - rep) <= 1e-4) == True


if __name__ == "__main__":
    print(
        "This is a test of the bat representation in chemreps to be evaluated with pytest"
    )
